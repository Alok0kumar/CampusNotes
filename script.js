// ---------- Materials dataset (original data preserved) ----------
const materials = [
  // 2nd Year - btech IT materials
  {
    year: "2nd Year",
    branch: "IT",
    subject: "Artificial Intelligence",
    title: "Unit-1",
    faculty: "Dr. Rajeev Kumar",
    link: "https://drive.google.com/file/d/1kqheALi7w7v10fnG39yqC1hHVAn_dXEl/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "Artificial Intelligence",
    title: "Unit-2",
    faculty: "Roshni Prasad",
    link: "https://drive.google.com/file/d/1MclKwdqaw8y6Y8dUIOcp6vPlwFO4nLBs/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "AICE",
    title: "Unit-1",
    faculty: "Ms. Kumari Kajal Kishore",
    link: "https://drive.google.com/file/d/14hmSP69f74lurfInC2DgFBVFR9-1aNSl/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "AICE",
    title: "Unit-2",
    faculty: "Ms. Kumari Kajal Kishore",
    link: "https://drive.google.com/file/d/1n5-91FGAxE1kC5GFQrcXmzHp2Fb_k6-9/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "CAPP",
    title: "Unit-1",
    faculty: "Ankur Kumar Varshney",
    link: "https://drive.google.com/file/d/1HlLy-tSUxSo0Gn5uWfrvFaY-Hygi89P_/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "CAPP",
    title: "Unit-2",
    faculty: "Dr. Ankita Rani",
    link: "https://drive.google.com/file/d/10CRoHIkT_OekP2qmvr3erXLtpnDtQNJz/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "DSA",
    title: "Unit-1",
    faculty: "VIKRANT MALIK",
    link: "https://drive.google.com/file/d/1fr4xOYNQWO0RchjobO2Pbnk4ZWku_GYM/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "DSA",
    title: "Unit-2",
    faculty: "Dr. Megha Gupta ",
    link: "https://drive.google.com/file/d/1SlCTbZXPBMySZ-iJLCYo6M5uoRI669Bp/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "Operating System",
    title: "Unit-1",
    faculty: "Mr. Atul Garg",
    link: "https://drive.google.com/file/d/1lsD19I_X9UlsdaiT19e5E-ulGoHnVFWA/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "Technical Communication",
    title: "Unit-1",
    faculty: "Not Available",
    link: "https://drive.google.com/file/d/1VFCGqmEVDKvcbLWyjuJDM4At6puxwdXB/view?usp=drive_link"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "Technical Communication",
    title: "Unit-2",
    faculty: "Not Available",
    link: "https://drive.google.com/file/d/1K5UOi_wOaNVuzL67JbU6BR1Iuc4vOhtD/view?usp=drive_link"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "Technical Communication",
    title: "Unit-3",
    faculty: "Not Available",
    link: "https://drive.google.com/file/d/1p9TVlJUq0a4TWhDM1eWOWhnyOE7jh779/view?usp=drive_link"
  }
];

// ---------- PYQ dataset (you can expand with real data) ----------
//2nd year Btech IT PYQs session 2024-25
const pyqs = [
  {
    year: "2nd Year",
    branch: "IT",
    subject: "AICE",
    semester: "Sem 3",
    title: "AICE-BNC0301",
    session: "2024-25",
    link: "https://drive.google.com/file/d/1fsy0Qoy45VI28P9G020zcunmLPFkWfPI/view?usp=sharing"
  },
  {
    year: "2nd Year",
    branch: "IT",
    subject: "Operating System",
    semester: "Sem 3",
    title: "OS-BNC0302",
    session: "2024-25",
    link:"https://drive.google.com/file/d/1U4Hu6GN43gFs6OqcdUS6X6vWfZLMudzQ/view?usp=sharing"
  },
  {
    year: "1st Year",
    branch: "IT",
    subject: "Engineering Mathematics",
    semester: "Sem 1",
    title: "Eng. Maths-BAS0103",
    session: "2024-25",
    link: "https://drive.google.com/file/d/1iBLeBkf6c9zjPZsQQCHY8n4vyFKDfmAp/view?usp=drive_link"
  },
  {
    year: "1st Year",
    branch: "IT",
    subject: "Engineering Physics",
    semester: "Sem 1",
    title: "Eng. Physics-BAS0101AZ",
    session: "2024-25",
    link: "https://drive.google.com/file/d/1SEIlqaeZQWX1_e7oT8ON2zR1eTds57RN/view?usp=drive_link"
   },
  {
    year: "1st Year",
    branch: "IT",
    subject: "German",
    semester: "Sem 1",
    title: "BASL0103-German",
    session: "2024-25",
    link: "https://drive.google.com/file/d/1FygQsHHYLeyzo-GpOwBmsmCAmXs5Ce0K/view?usp=drive_link"
  },
  {
    year: "1st Year",
    branch: "IT",
    subject: "French",
    semester: "Sem 1",
    title: "BASL0102-French",
    session: "2024-25",
    link: "https://drive.google.com/file/d/1vWdQRDOstBD2hesXgFjQ92GD5n4bEI-m/view?usp=drive_link"
  },
  {
    year: "1st Year",
    branch: "IT",
    subject: "Japanese",
    semester: "Sem 1",
    title: "BASL0104-Japnese",
    link: "https://drive.google.com/file/d/1x7MyLgs8IOVl2-1f9xXoaqgrIC1NoPt1/view?usp=drive_link"
  }
  
  
];

// ---------- Elements ----------
const yearSelect = document.getElementById("yearSelect");
const branchSelect = document.getElementById("branchSelect");
const subjectSelect = document.getElementById("subjectSelect");
const materialList = document.getElementById("materialList");

// ---------- Subject Updater ----------
function updateSubjects() {
  const year = yearSelect.value;
  const branch = branchSelect.value;

  const subjects = new Set();

  materials.forEach((item) => {
    if (item.year === year && item.branch === branch) {
      subjects.add(item.subject);
    }
  });

  subjectSelect.innerHTML = '<option value="">Select Subject</option>';

  // Add "All" option (only for PYQ)
  const allOption = document.createElement("option");
  allOption.value = "All";
  allOption.textContent = "All";
  subjectSelect.appendChild(allOption);

  subjects.forEach((subject) => {
    const option = document.createElement("option");
    option.value = subject;
    option.textContent = subject;
    subjectSelect.appendChild(option);
  });
}

// ---------- Display Materials ----------
function displayMaterials() {
  const year = yearSelect.value;
  const branch = branchSelect.value;
  const subject = subjectSelect.value;

  const filtered = materials.filter(
    (item) => item.year === year && item.branch === branch && item.subject === subject
  );

  materialList.innerHTML = "";

  if (filtered.length === 0) {
    materialList.innerHTML = '<p>No materials found.</p>';
    return;
  }

  filtered.forEach((material) => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <h3>${material.title}</h3>
      <p><strong>Subject:</strong> ${material.subject}</p>
      <p><strong>Faculty:</strong> ${material.faculty}</p>
      <a href="${material.link}" target="_blank">View Material</a>
    `;

    materialList.appendChild(card);
  });
}

// ---------- Display PYQs ----------
function displayPYQs() {
  const year = yearSelect.value;
  const branch = branchSelect.value;
  const subject = subjectSelect.value;
  const semester = document.getElementById("semesterSelect").value;

  let filtered;

  if (subject === "All") {
    // Show all subjects for selected year+branch+semester
    filtered = pyqs.filter(item =>
      item.year === year &&
      item.branch === branch &&
      item.semester === semester
    );
  } else {
    filtered = pyqs.filter(item =>
      item.year === year &&
      item.branch === branch &&
      item.subject === subject &&
      item.semester === semester
    );
  }

  materialList.innerHTML = "";

  if (filtered.length === 0) {
    materialList.innerHTML = "<p>No PYQs found.</p>";
    return;
  }

  filtered.forEach((pyq) => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
  <h3>${pyq.title}</h3>
  <p><strong>Subject:</strong> ${pyq.subject}</p>
  <p><strong>Semester:</strong> ${pyq.semester}</p>
  <p><strong>Session:</strong> ${pyq.session}</p>   <!-- ✅ New line -->
  <a href="${pyq.link}" target="_blank">View PYQ</a>
`;

    materialList.appendChild(card);
  });
}

// ---------- Event Listeners ----------
yearSelect.addEventListener("change", () => {
  updateSubjects();
  materialList.innerHTML = "";
  document.getElementById("actionButtons").innerHTML = "";
  document.getElementById("semesterSection").style.display = "none";
});

branchSelect.addEventListener("change", () => {
  updateSubjects();
  materialList.innerHTML = "";
  document.getElementById("actionButtons").innerHTML = "";
  document.getElementById("semesterSection").style.display = "none";
});

subjectSelect.addEventListener("change", () => {
  const subject = subjectSelect.value;
  const actionButtons = document.getElementById("actionButtons");
  actionButtons.innerHTML = "";

  if (!subject) return;

  // Always add View PYQ
  const pyqBtn = document.createElement("button");
  pyqBtn.textContent = "View PYQ";
  pyqBtn.onclick = () => {
  const semesterSelect = document.getElementById("semesterSelect");
  const year = yearSelect.value;

  // Mapping Year → Semesters
  const yearSemesterMap = {
    "1st Year": ["Sem 1", "Sem 2"],
    "2nd Year": ["Sem 3", "Sem 4"],
    "3rd Year": ["Sem 5", "Sem 6"],
    "4th Year": ["Sem 7", "Sem 8"]
  };

  // Reset semester options
  semesterSelect.innerHTML = '<option value="">Select Semester</option>';

  // Populate based on selected year
  if (yearSemesterMap[year]) {
    yearSemesterMap[year].forEach(sem => {
      const option = document.createElement("option");
      option.value = sem;
      option.textContent = sem;
      semesterSelect.appendChild(option);
    });
  }

  // Show semester section
  document.getElementById("semesterSection").style.display = "flex";

  // Clear previous list
  materialList.innerHTML = "";
};

  actionButtons.appendChild(pyqBtn);

  // Add View Material only if subject !== All
  if (subject !== "All") {
    const matBtn = document.createElement("button");
    matBtn.textContent = "View Material";
    matBtn.onclick = displayMaterials;
    actionButtons.appendChild(matBtn);
  }
});

document.getElementById("semesterSelect").addEventListener("change", displayPYQs);

